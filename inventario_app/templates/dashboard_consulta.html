<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Panel de Consulta</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="{{ url_for('static', filename='logo.png') }}">
  <style>
    :root{
      --azul-rey:#003366; --celeste:#e6f0ff; --rojo:#e74c3c; --rojo-hover:#c0392b;
      --boton-borde:#1c5e8c; --azul:#3498db; --azul-hover:#2980b9; --gris-oscuro:#2c3e50;
    }
    body{margin:0;font-family:'Segoe UI',sans-serif;background:var(--celeste);color:var(--gris-oscuro)}
    .topbar{background:var(--azul-rey); color:#fff; padding:18px 20px; display:flex; align-items:center; justify-content:center; gap:12px; border-bottom:3px solid #001f3f; box-shadow:0 2px 8px rgba(0,0,0,.25); position:relative;}
    .topbar img{height:60px}
    .topbar .title{font-size:26px;font-weight:700}
    .top-actions{position:absolute; right:20px; top:16px; display:flex; gap:12px; align-items:center}
    .btn{display:inline-block; background:var(--azul); color:#fff!important; padding:12px 14px; text-decoration:none; border-radius:8px; font-size:15px; font-weight:700; border:2px solid var(--boton-borde); box-shadow:0 4px 10px rgba(0,0,0,.06); transition:background-color .2s ease, transform .1s ease, filter .2s ease; text-align:center; cursor:pointer;}
    .btn:hover{background:var(--azul-hover); transform:translateY(-1px)}
    .btn-secondary{background:#6c8ebf; border-color:#3d5f91}
    .btn-secondary:hover{filter:brightness(0.95)}
    .btn-danger{background:var(--rojo); border-color:#001f3f}
    .btn-danger:hover{background:var(--rojo-hover)}
    .chat-btn{position:relative}
    .chat-notif{position:absolute; top:-5px; right:-5px; background:red; color:#fff; font-size:12px; padding:2px 6px; border-radius:50%;}
    .container{max-width:900px; margin:40px auto; background:#fff; padding:30px; border-radius:12px; box-shadow:0 0 10px rgba(0,0,0,.1); text-align:center;}
    h2{margin:0 0 12px; font-size:24px; color:var(--azul-rey)}
    .alert-box{background:#ecf0f1; border-left:5px solid var(--azul); padding:15px; text-align:left; margin:20px 0 25px; border-radius:6px;}
    .alert-box strong{display:block; margin-bottom:6px}
    .btn-grid{display:grid; grid-template-columns:1fr 1fr; gap:15px; margin-top:20px}
    @media (max-width:600px){
      .topbar{flex-direction:column; text-align:center}
      .top-actions{position:static; margin-top:10px}
      .container{margin:20px; padding:20px}
      .btn-grid{grid-template-columns:1fr}
    }
  </style>
</head>
<body>

  <div class="topbar">
    <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo">
    <div class="title">Celulares Cr√©dito F√°cil ‚Äî Panel de Consulta</div>
    <div class="top-actions">
      <a href="/chat" class="btn chat-btn">
        üí¨ Chat <span id="notif" class="chat-notif" style="display:none;">!</span>
      </a>
      <a href="/logout" class="btn btn-danger">Cerrar sesi√≥n</a>
    </div>
  </div>

  <div class="container">
    <h2>Bienvenido {{ usuario }} ‚Äî Consulta</h2>

    <div class="alert-box">
      <strong>Modo consulta activado</strong>
      Est√°s visualizando informaci√≥n solo de la sucursal: <b>{{ sucursal }}</b>.<br>
      Puedes consultar el inventario y confirmar transferencias si es necesario.
    </div>

    <div class="btn-grid">
      <a href="/inventario-sucursal" class="btn">üì¶ Ver inventario</a>
      <a href="/confirmar-transferencias" class="btn">‚úÖ Confirmar transferencias</a>
      <a href="/recibir-garantia" class="btn">üì¶üîÅ Recibir Garant√≠a</a>
      <a href="/inventario-sucursal" class="btn">üìã Ir a Inventario</a>
      <a href="{{ url_for('ir_caja') }}" class="btn btn-secondary link-btn">‚Ü© Volver a Caja</a>
    </div>

    <p style="margin-top: 28px; color:#7f8c8d;">üîß Pr√≥ximamente se habilitar√°n m√°s funciones para tu rol.</p>
  </div>

  <script>
    async function revisarNotificaciones(){
      try{
        const res = await fetch("/chat/notificaciones?modulo=Inventario", {cache:"no-store"});
        const data = await res.json();
        if(data.nuevos>0){
          const n=document.getElementById("notif");
          n.style.display="inline-block";
          n.textContent=data.nuevos;
        }
      }catch(e){}
    }
    revisarNotificaciones();
    setInterval(revisarNotificaciones, 5000);
  </script>

</body>
</html>
